Q1. Retrieve the total number of rentals made in the Sakila database. 
A1. SELECT COUNT(*) AS total_rentals FROM rental;
    16044

Q2. Find the average rental duration (in days) of movies rented from the Sakila database.
A2. SELECT AVG(rental_duration) AS average_rental_duration FROM film;
     4.9850

Q3. Display the first name and last name of customers in uppercase. 
A3. SELECT UPPER(first_name) AS FIRST_NAME,
       UPPER(last_name) AS LAST_NAME
    FROM customer;

Q4. Extract the month from the rental date and display it alongside the rental ID. 
A4.  SELECT rental_id,
       MONTH(rental_date) AS rental_month
     FROM rental;
    
Q5. Retrieve the count of rentals for each customer (display customer ID and the count of rentals). 
A5. SELECT customer_id,
       COUNT(rental_id) AS rental_count
    FROM rental
    GROUP BY customer_id;

Q6. Find the total revenue generated by each store. 
A6. SELECT s.store_id,
       CONCAT(st.first_name, ' ', st.last_name) AS manager_name,
       SUM(p.amount) AS total_revenue
       FROM store s
       JOIN staff st ON s.manager_staff_id = st.staff_id
       JOIN customer c ON s.store_id = c.store_id
       JOIN payment p ON c.customer_id = p.customer_id
       GROUP BY s.store_id, manager_name;
        

       Mike Hillyer	37001.52
       Jon Stephens	30414.99

Q7.   Display the title of the movie, customer's first name, and last name who rented it. 
A7.   SELECT f.title,
       c.first_name,
       c.last_name
       FROM rental r
       JOIN inventory i ON r.inventory_id = i.inventory_id
       JOIN film f ON i.film_id = f.film_id
       JOIN customer c ON r.customer_id = c.customer_id;

Q8.  Retrieve the names of all actors who have appeared in the film "Gone with the Wind." 
A8.  SELECT a.first_name,
       a.last_name
      FROM actor a
      JOIN film_actor fa ON a.actor_id = fa.actor_id
      JOIN film f ON fa.film_id = f.film_id
      WHERE f.title = 'Gone with the Wind';

Q9.  Determine the total number of rentals for each category of movies. 
A9.  SELECT cat.name AS category_name,
       COUNT(r.rental_id) AS total_rentals
       FROM rental r
       JOIN inventory i ON r.inventory_id = i.inventory_id
       JOIN film f ON i.film_id = f.film_id
       JOIN film_category fc ON f.film_id = fc.film_id
       JOIN category cat ON fc.category_id = cat.category_id
       GROUP BY cat.category_id, cat.name
       ORDER BY total_rentals DESC;

Q10.  Find the average rental rate of movies in each language. 
A10.  2.9000

Q11.  Retrieve the customer names along with the total amount they've spent on rentals. 
A11.  SELECT c.first_name,
       c.last_name,
       SUM(p.amount) AS total_amount_spent
       FROM customer c
       JOIN payment p ON c.customer_id = p.customer_id
       GROUP BY c.customer_id, c.first_name, c.last_name
       ORDER BY total_amount_spent DESC;

Q12.  List the titles of movies rented by each customer in a particular city (e.g., 'London'). 
A12.  SELECT c.customer_id,
       c.first_name,
       c.last_name,
       f.title AS movie_title
       FROM customer c
       JOIN address a ON c.address_id = a.address_id
       JOIN city ci ON a.city_id = ci.city_id
       JOIN rental r ON c.customer_id = r.customer_id
       JOIN inventory i ON r.inventory_id = i.inventory_id
       JOIN film f ON i.film_id = f.film_id
       WHERE ci.city = 'London'
       ORDER BY c.customer_id, f.title;

Q13.  Display the top 5 rented movies along with the number of times they've been rented. 
A13.  SELECT f.title AS movie_title,
       COUNT(r.rental_id) AS times_rented
       FROM rental r
       JOIN inventory i ON r.inventory_id = i.inventory_id
       JOIN film f ON i.film_id = f.film_id
       GROUP BY f.film_id, f.title
       ORDER BY times_rented DESC
       LIMIT 5;

Q14.  Determine the customers who have rented movies from both stores (store ID 1 and store ID 2). 
A14.  SELECT r.customer_id,
       c.first_name,
       c.last_name
       FROM rental r
       JOIN customer c ON r.customer_id = c.customer_id
       WHERE r.store_id IN (1, 2)
       GROUP BY r.customer_id, c.first_name, c.last_name
       HAVING COUNT(DISTINCT r.store_id) = 2;
